# 2020년 3월 4일
서버를 배포하려고 공식 문서를 찾아보다가 장고 상용 서버를 runserver 커맨드로 배포하면 안 된다(권장하지 않는다)는 것을 알게 되었다. 데몬으로 돌리고 있었는데 싱글 쓰레드로 처리하는 것이 낮은 성능을 보인다고 한다. 그래서 nginx 등을 사용하려고 했는데, 이 과정에서 도커를 도입하는 것이 어떻겠냐는 선임 개발자님의 말씀이 있어서 간단하게 도커 개념을 정리해보게 되었다.


### Virtual Machine vs. Docker
1. VM
- 로컬 자원(RAM/HD/CPU 등)을 할당받는다.
- exactly
- 할당받은 자원을 전부 사용하지 못한다.

2. Docker
- 로컬 자원을 그대로 사용한다. (논리적 분리)
- at most
- 컨테이너에 동적으로 할당된다.

====> 가상머신은 운영체제 위에 하드웨어를 에뮬레이션하고 그 위에 운영체제를 올리고 프로세스를 실행하는 반면에, 도커 컨테이너는 하드웨어 에뮬레이션 없이 리눅스 커널을 공유해서 바로 프로세스를 실행한다.


### 도커란
- 재사용할 수 있는 격리된 환경을 간단하게 만들 수 있는 기술.
- 리눅스 기반 (= 리눅스 커널을 사용함)


### 원리
도커 허브와 같은 레지스트리(registry)를 사용하여 환경 구축을 위한 정보인 '도커파일(Dockerfile)'을 가져올 수 있다. 이 도커파일을 기반으로 '이미지'를 생성한다. 하나의 이미지로 여러개의 '컨테이너'를 만들 수 있다.  


### 도커파일 예시
```
FROM ubuntu:10 
RUN apt-get update -y
RUN py
RUN dj
WORKDIR /app

ENV NODE_ENV=development

CMD ['./run_server.sh']
```
- centOS의 경우 yum을 사용한다.


### 이미지
특정 프로세스를 실행하기 위한 환경


### 컨테이너
- 일종의 프로세스
- 호스트 OS상에 논리적인 구획(컨테이너)을 만들고, 어플리케이션을 작동시키기 위해 필요한 라이브러리나 어플리케이션 등을 하나로 모아, 마치 별도의 서버인 것처럼 사용할 수 있게 만든 것
- 이미지와 컨테이너 모두 이름을 지정할 수 있다.


### 명령어
```
docker build
```
도커파일을 사용하여 이미지를 만든다.

```
docker run
```
이미지로 컨테이너를 만들고 실행한다.