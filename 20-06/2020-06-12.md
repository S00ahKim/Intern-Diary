# 2020년 6월 12일

### 장고+리액트 vs 장고+노드
- 노드가 실시간 데이터 처리, 장고는 다양한 데이터 관리에 유용함


### node.js
- 구글의 Chrome V8엔진 위에서 구현된 자바스크립트를 위한 런타임 환경(프로그램언어가 브라우저에서 프로그래머로서 실행되고 있는 장소). 자바스크립트는 프로그래밍 언어, Nodejs는 자바스크립트가 브라우저 동작 할 수 있도록 도와주는 환경이라고 볼 수 있음.

- 특징
1. V8엔진
1-1. 빠른 프로퍼티 접근
여타 자바스크립트 엔진은 프로퍼티를 저장하기 위해 "딕셔너리식 구조"를 사용한다. 노드가 구현된 V8엔진은 "히든 클래스"를 사용한다. 전자가 해싱이라면 후자는 포인터다. V8은 객체에 새로운 프로퍼티를 추가할 때, 프로퍼티의 정적 위치를 저장한다. 

이것의 장점은 동적 룩업이 필요 없어지고, 고전적인 클래스 기반의 최적화를 할 수 있다는 것이다. 

> 동적 룩업? 데이터 타입이 동적으로 정해지는 코드로는 프로퍼티의 메모리 오프셋을 컴파일할 때 결정하는 것은 불가능합니다. 프로퍼티를 선언했을 때의 프로퍼티의 데이터 타입이나 순서가 실제로 프로퍼티 값을 접근할 때는 달라질 수 있기 때문이지요. 따라서 프로퍼티를 선언했을 때의 오프셋 값은 참조할 수 없게 되고, 이에 대한 대책이 따로 없는 한, 프로퍼티 값을 읽어야 할 때마다 프로퍼티를 찾아내야 합니다. 즉 동적 탐색(dynamic lookup)이 필요합니다. 자바스크립트처럼 사전형(dictionary) 형태의 객체를 이용한다면, 객체의 프로퍼티를 읽어들일 때 비용이 발생하며 이 비용은 구현 방식에 따라 달라집니다. [출처](https://engineering.linecorp.com/ko/blog/v8-hidden-class/)

매번 프로퍼티를 추가할 때마다 새로운 히든 클래스를 생성하는 방식은 상당히 비효율적이지만, 다음 번에 같은 객체를 생성할 때 이전에 생성했던 히든 클래스를 재사용함으로써 객체 생성 비용을 줄일 수 있다.

1-2. 동적인 기계어 코드 생성(Dynamic Machine code Generation) 

V8은 JavaScript 소스 코드를 처음 컴파일 할 때 bytecode가 아닌 기계어 코드로 직접 변환한다. 따라서 중간에 bytecode를 기계어로 변환해 줄 인터프리터가 필요 없다. 기계어로 컴파일 할 때는 인라인 캐싱 코드(Inline caching code) 기법을 이용한다.

1-3. 효율적인 가비지 콜렉션(Efficient Garbage Collection)

V8은 Garbage Collection Cycle을 수행할 때 프로그램 실행을 멈추는데, 이때 객체의 heap 부분만 처리함으로써 프로그램이 멈추는 영향을 최소화한다. 또한 객체와 포인터가 메모리상에 어디에 위치해 있는지 정확히 관리하여 메모리 누수를 피한다.


2. 논블로킹 비동기 실행

일반적인 동기 모델은 특정 라인의 코드가 있다고 가정하면 그 이전 코드들의 연산이 다 끝날 때까지 기다려야 한다. 즉 이전 이벤트가 끝나지 않으면 메모리를 계속적으로 점유 하고 있고 완료 될때 까지 대기 상태가 된다. 하지만 비동기 모델에서는 조금 다르게 동작한다. 비동기적으로 처리하는 요청과 결과 처리가 동시에 일어나지 않는다. 그러므로 "이벤트가 중단 되지 않고 계속적으로 실행"된다. 그리고 이전 코드의 연산은 결과가 나오면 그때 리턴 된다.

3. 싱글스레드!

nodejs 요청들이 모두 같은 스레드에서 실행된다. 클라이언트오는 요청들을 하나의 스레드에서 받아드리고 사실 내부적으로는 멀티스레드로 작업이 된다. 자세한 이해는 이 링크를 참조 바란다.

4. 서버도 구현 가능!

나는 개인적으로 앞으로는 javascript의 영향력이 날로 커질거라고 생각한다. javascript는 이미 많은 영역에서 영향력을 가지고 있다. 그래서 나올 수 있는 장점이다. 클라이언트, 서버사이드 영역을 javasript로 개발 할 수 있다. 이는 프로젝트의 개발 단계에서나 유지보수 단계에서나 시간, 인력, 효율 등에서 큰 이점이 될 수 있다.

[참고](https://seungwoohong.tistory.com/7)